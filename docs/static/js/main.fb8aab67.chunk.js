(this["webpackJsonpwasm-audio-app"]=this["webpackJsonpwasm-audio-app"]||[]).push([[0],{16:function(e,t,n){e.exports=n(27)},21:function(e,t,n){},23:function(e,t,n){},27:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(9),s=n.n(o),c=(n(21),n(1)),i=n.n(c),u=n(3),l=n(6),d=(n(23),n(10)),p=n(11),h=n(14),m=n(12),w=n(15),f=function(e){Object(m.a)(n,e);var t=Object(h.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"init",value:function(e,t,n){var a=this;this.onPitchDetectedCallback=t,this.numAudioSamplesPerAnalysis=n,this.port.onmessage=function(e){return a.onmessage(e.data)},this.port.postMessage({type:"send-wasm-module",wasmBytes:e})}},{key:"onprocessorerror",value:function(e){console.log("An error from AudioWorkletProcessor.process() occurred: ".concat(e))}},{key:"onmessage",value:function(e){"wasm-module-loaded"===e.type?this.port.postMessage({type:"init-detector",sampleRate:this.context.sampleRate,numAudioSamplesPerAnalysis:this.numAudioSamplesPerAnalysis}):"pitch"===e.type&&this.onPitchDetectedCallback(e.pitch)}}]),n}(Object(w.a)(AudioWorkletNode));function v(){return b.apply(this,arguments)}function b(){return(b=Object(u.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.navigator.mediaDevices){e.next=2;break}throw new Error("This browser does not support web audio or it is not enabled.");case 2:return e.prev=2,e.next=5,window.navigator.mediaDevices.getUserMedia({audio:!0,video:!1});case 5:return t=e.sent,e.abrupt("return",t);case 9:e.prev=9,e.t0=e.catch(2),e.t1=e.t0.name,e.next="NotAllowedError"===e.t1?14:"NotFoundError"===e.t1?15:16;break;case 14:throw new Error("A recording device was found but has been disallowed for this application. Enable the device in the browser's settings.");case 15:throw new Error("No recording device was found. Please attach a microphone and click Retry.");case 16:throw e.t0;case 17:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}function g(e){return k.apply(this,arguments)}function k(){return(k=Object(u.a)(i.a.mark((function e(t){var n,a,r,o,s,c,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v();case 2:return n=e.sent,a=new window.AudioContext,r=a.createMediaStreamSource(n),e.prev=5,e.next=8,window.fetch("wasm-audio/wasm_audio_bg.wasm");case 8:return s=e.sent,e.next=11,s.arrayBuffer();case 11:return c=e.sent,u="PitchProcessor.js",e.prev=13,e.next=16,a.audioWorklet.addModule(u);case 16:e.next=21;break;case 18:throw e.prev=18,e.t0=e.catch(13),new Error("Failed to load audio analyzer worklet at url: ".concat(u,". Further info: ").concat(e.t0.message));case 21:o=new f(a,"PitchProcessor"),2048,o.init(c,t,2048),r.connect(o),o.connect(a.destination),e.next=31;break;case 28:throw e.prev=28,e.t1=e.catch(5),new Error("Failed to load audio analyzer WASM module. Further info: ".concat(e.t1.message));case 31:return e.abrupt("return",{context:a,node:o});case 32:case"end":return e.stop()}}),e,null,[[5,28],[13,18]])})))).apply(this,arguments)}var x=n(13);function y(e){var t=e.running,n=e.latestPitch;return r.a.createElement(x.RadialGauge,{units:"Hz",title:"Frequency",value:n?"".concat(n.toFixed(1)):t?"80":"0",minValue:77,maxValue:87,majorTicks:["77","78","79","80","81","82","83","84","85","86","87"],minorTicks:2,strokeTicks:!0,highlights:[{from:77,to:82,color:"rgba(0,0, 255, .3)"},{from:82,to:87,color:"rgba(255, 0, 0, .3)"}],width:400,height:400})}function E(){var e=r.a.useState(void 0),t=Object(l.a)(e,2),n=t[0],a=t[1],o=r.a.useState(!1),s=Object(l.a)(o,2),c=s[0],d=s[1],p=r.a.useState(void 0),h=Object(l.a)(p,2),m=h[0],w=h[1];if(!n)return r.a.createElement("button",{onClick:Object(u.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=a,e.next=3,g(w);case 3:e.t1=e.sent,(0,e.t0)(e.t1),d(!0);case 6:case"end":return e.stop()}}),e)})))},"Start listening");var f=n.context;return r.a.createElement("div",null,r.a.createElement("button",{onClick:Object(u.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c){e.next=6;break}return e.next=3,f.suspend();case 3:d("running"===f.state),e.next=9;break;case 6:return e.next=8,f.resume();case 8:d("running"===f.state);case 9:case"end":return e.stop()}}),e)}))),disabled:"running"!==f.state&&"suspended"!==f.state},c?"Pause":"Resume"),r.a.createElement("div",null),r.a.createElement(y,{running:c,latestPitch:m}))}var A=function(){return r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"App-content"},r.a.createElement(E,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(A,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[16,1,2]]]);
//# sourceMappingURL=main.fb8aab67.chunk.js.map